# DeepDiary 功能需求文档

## 一、功能需求概述

### 1.1 记忆追溯功能需求

#### 1.1.1 数据源管理

**需求描述：** 系统需要支持多种数据源的整合和管理。

**功能点：**

- 📝 **日记管理**

  - 支持文本日记录入
  - 支持日记分类和标签
  - 支持日记检索和展示

- 📷 **照片管理**

  - 集成 Immich 照片库
  - 支持人脸识别和自动标注
  - 支持照片检索（按人物、地点、时间）

- 📍 **GPS 轨迹管理**

  - 记录位置信息
  - 记录轨迹数据
  - 支持轨迹可视化

- 💬 **聊天记录管理**
  - 记录所有对话历史
  - 支持对话检索
  - 支持对话关联

#### 1.1.2 记忆检索功能

**需求描述：** 支持多维度记忆检索。

**功能点：**

- **时间线检索**：按时间顺序展示记忆
- **人物检索**：基于人物关联检索记忆
- **地点检索**：基于地理位置检索记忆
- **事件检索**：基于关键词和语义检索记忆
- **组合检索**：支持多条件组合查询

#### 1.1.3 记忆展示功能

**需求描述：** 以多种方式展示记忆内容。

**功能点：**

- **Markdown 展示**：格式化展示记忆内容
- **图片网格**：展示相关照片
- **时间线展示**：时间轴形式展示记忆
- **关系图谱**：展示人物关系网络
- **地图轨迹**：在地图上展示 GPS 轨迹

### 1.2 资源追溯功能需求

#### 1.2.1 资源管理

**需求描述：** 管理用户的三大资源。

**功能点：**

- **资源录入**

  - 技能资源：专业技能、知识、经验
  - 人脉资源：社交网络、关系链
  - 资产资源：物质资产、时间、空间

- **资源更新**：支持资源的动态更新
- **资源验证**：验证资源的真实性

#### 1.2.2 需求管理

**需求描述：** 管理用户的三大需求。

**功能点：**

- **需求录入**

  - 学习需求：技能提升、知识获取
  - 社交需求：人脉拓展、关系建立
  - 物质需求：资产获取、服务需求

- **需求更新**：支持需求的动态更新
- **需求优先级**：设置需求紧急程度

#### 1.2.3 智能匹配功能

**需求描述：** 智能匹配资源和需求。

**功能点：**

- **资源-需求匹配**：根据需求匹配资源
- **需求-资源匹配**：根据资源匹配需求
- **匹配度评分**：计算匹配质量
- **机会推荐**：推荐服务机会

### 1.3 Web 界面功能需求

#### 1.3.1 智能聊天界面

**需求描述：** 左右布局的智能聊天界面。

**功能点：**

- **左侧聊天区**

  - 显示聊天记录（文本、图片）
  - 支持语音/文字输入
  - 支持设备控制指令

- **右侧记忆区**
  - 动态显示记忆片段
  - 展示相关图片
  - 实时更新内容

#### 1.3.2 设备控制界面

**需求描述：** 通过 UI 控制设备。

**功能点：**

- 设备列表展示
- 设备状态显示
- 控制指令下发
- 批量操作支持

### 1.4 新朋友识别功能需求

#### 1.4.1 自动识别流程

**需求描述：** 自动识别新朋友并引导注册。

**功能点：**

- **人脸识别**：自动识别人脸
- **未识别处理**：未找到时触发新朋友流程
- **对话引导**：引导确认姓名
- **自动命名**：调用 Immich API 自动命名
- **声纹注册**：自动注册声纹
- **信息关联**：关联聊天信息到人物

#### 1.4.2 资源追溯引导

**需求描述：** 引导新朋友录入资源和需求。

**功能点：**

- **智能对话**：充当采访者角色
- **信息收集**：收集三大资源和三大需求
- **信息确认**：确认信息准确性
- **自动匹配**：录入后自动匹配

## 二、非功能性需求

### 2.1 性能需求

- **响应时间**：记忆检索响应时间 < 2 秒
- **并发支持**：支持至少 100 个并发连接
- **数据处理**：支持百万级记忆数据检索

### 2.2 可靠性需求

- **服务可用性**：99.9% 可用性
- **数据备份**：定期数据备份
- **错误处理**：完善的错误处理和降级方案

### 2.3 安全性需求

- **数据加密**：敏感数据加密存储
- **访问控制**：基于角色的访问控制
- **隐私保护**：保护用户隐私数据

### 2.4 可扩展性需求

- **模块化设计**：支持功能模块扩展
- **插件系统**：支持插件扩展
- **API 开放**：提供开放 API

## 三、用户故事

### 3.1 记忆追溯用户故事

**作为用户，我希望：**

- 能够通过语音查询历史照片
- 能够查看与特定人物的互动历史
- 能够在地图上查看生活轨迹
- 能够通过关键词检索相关记忆

### 3.2 资源追溯用户故事

**作为用户，我希望：**

- 能够录入我的资源和需求
- 系统能够自动匹配相关资源
- 系统能够推荐服务机会
- 能够查看匹配结果和推荐理由

### 3.3 新朋友识别用户故事

**作为用户，我希望：**

- 新朋友来访时系统自动识别
- 系统能够引导新朋友录入信息
- 系统能够自动匹配资源和需求
- 能够查看匹配结果和服务机会

## 四、功能优先级

### Phase 1：核心功能（高优先级）

- 记忆检索基础功能
- 资源追溯基础功能
- Web 界面基础功能
- 新朋友识别基础流程

### Phase 2：增强功能（中优先级）

- 记忆可视化增强
- 资源匹配算法优化
- 智能对话引导系统
- 多维度匹配功能

### Phase 3：扩展功能（低优先级）

- 插件系统
- 开放 API
- 数据分析功能
- 报表功能
